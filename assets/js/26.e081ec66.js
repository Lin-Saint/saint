(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{416:function(e,n,t){"use strict";t.r(n);var a=t(2),o=Object(a.a)({},(function(){var e=this,n=e._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("h1",{attrs:{id:"深拷贝"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#深拷贝"}},[e._v("#")]),e._v(" 深拷贝")]),e._v(" "),n("p",[e._v("简单版")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("function deepClone(obj) {\n    if typeof obj !== 'object' return;\n    let newObj = Array.isArray(obj) ? [] : {};\n    for(let key in obj) {\n        if(obj.hasOwnProperty(key)) {\n            newObj[key] = typeof obj[key] === 'object' ? deepClone(obj[key]) : obj[key]\n        }\n    }\n    return newObj\n}\n")])])]),n("p",[e._v("考虑到循环引用以及map，set类型的深拷贝")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("function cloneDeep(obj, map = new WeakMap()) {\n    if (typeof obj !== 'object' || obj === null ) return obj;\n\n    let target = {}\n    const memory = map.get(obj);\n    if (memory) {\n        console.log(memory)\n        return memory\n    }\n\n    map.set(obj,target)\n\n    if (obj instanceof Map) {\n        target = new Map()\n\n        obj.forEach((v,k)=>{\n            const value1 = cloneDeep(v,map);\n            const key1 = cloneDeep(k,map);\n            target.set(key1,value1)\n        })\n    }\n\n    if (obj instanceof Set) {\n        target = new Set()\n\n        obj.forEach(v=>{\n            const value1 = cloneDeep(v,map);\n            target.add(value1)\n        })\n    }\n\n    if (Array.isArray(obj)) {\n        target = []\n\n        for(let key in obj) {\n            target[key] = cloneDeep(obj[key],map)\n        }\n    }\n    if (Object.prototype.toString.call(obj) === '[object Object]') {\n        \n\n        for (let key in obj) {\n            // const value = cloneDeep(obj[key],map)\n            target[key] = cloneDeep(obj[key],map)\n        }\n    }\n\n    return target\n}\n\n")])])]),n("p",[e._v("测试代码:")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("const target = {\n    field1: 1,\n    field2: undefined,\n    field3: {\n        child: 'child'\n    },\n    field4: [2, 4, 8]\n};\ntarget.target = target;\n\nconst result = cloneDeep(target);\nconsole.log(result)\n\n")])])])])}),[],!1,null,null,null);n.default=o.exports}}]);